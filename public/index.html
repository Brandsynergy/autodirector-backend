<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Mediad AutoDirector</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="icon" href="/logo.png" />
  <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans:wght@400;600;700&family=IBM+Plex+Mono:wght@400;600&display=swap" rel="stylesheet">
  <style>
    :root{--bg:#0b0c10;--surface:#14151a;--surface-2:#181a20;--border:#262933;--text:#eef0f4;--muted:#a6a8ad;--accent:#b08a46;--accent-2:#94743b}
    *{box-sizing:border-box}
    body{margin:0;background:var(--bg);color:var(--text);font-family:"IBM Plex Sans",system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif}
    .wrap{max-width:1120px;margin:0 auto;padding:28px 18px 40px}
    .header{display:flex;align-items:center;gap:14px;margin-bottom:18px}
    .logo{width:40px;height:40px;display:block;object-fit:contain}
    .title{font-weight:700;font-size:22px;letter-spacing:.2px}
    .tag{color:var(--muted);font-size:12px;margin-top:2px}
    .card{background:var(--surface);border:1px solid var(--border);border-radius:14px;padding:16px}
    h3{margin:0 0 10px 0;font-size:15px;letter-spacing:.2px}
    textarea{width:100%;min-height:90px;resize:vertical;outline:none;background:var(--surface-2);color:var(--text);border:1px solid var(--border);border-radius:12px;padding:12px 14px;font-size:15px}
    textarea:focus{border-color:var(--accent);box-shadow:0 0 0 3px #b08a4626}
    .row{display:flex;gap:10px;align-items:center;flex-wrap:wrap}
    .btn{cursor:pointer;padding:10px 14px;font-weight:600;font-size:14px;border-radius:10px;border:1px solid transparent;background:var(--surface-2);color:var(--text)}
    .btn.primary{background:var(--accent);border-color:var(--accent);color:#111}.btn.primary:hover{background:var(--accent-2)}
    .btn.ghost{background:transparent;border:1px solid var(--border)}
    .grid{display:grid;grid-template-columns:1fr;gap:16px}@media(min-width:1000px){.grid{grid-template-columns:1fr 1fr}}
    pre{margin:0;white-space:pre-wrap;min-height:120px;background:var(--surface-2);color:var(--text);border:1px solid var(--border);border-radius:12px;padding:12px;font-family:"IBM Plex Mono",ui-monospace,Menlo,Consolas,monospace;font-size:13px}
    .hint{color:var(--muted);font-size:12px;margin-top:6px}
    .chips{display:flex;flex-wrap:wrap;gap:8px;margin-top:10px}.chip{cursor:pointer;background:var(--surface-2);border:1px solid var(--border);color:var(--text);padding:8px 12px;border-radius:999px;font-size:12px}
    .status{color:var(--muted);font-size:12px}.status strong{color:var(--text)}
    .shots{display:grid;grid-template-columns:repeat(auto-fill,minmax(160px,1fr));gap:8px;margin-top:10px}
    .thumb{border:1px solid var(--border);border-radius:10px;overflow:hidden;background:#0f1115}.thumb img{display:block;width:100%;height:auto}
    footer{margin-top:18px;color:var(--muted);font-size:12px;text-align:center}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="header">
      <img src="/logo.png" alt="Mediad logo" class="logo" />
      <div>
        <div class="title">Mediad AutoDirector</div>
        <div class="tag">Natural-language browser automation</div>
      </div>
    </div>

    <div class="card">
      <h3>Describe what to automate</h3>
      <textarea id="prompt" placeholder='e.g. "Screenshot https://www.cnn.com and email to …"'></textarea>
      <div class="row" style="margin-top:10px">
        <button id="planBtn" class="btn">Plan</button>
        <button id="runBtn" class="btn primary">Run</button>
        <div id="statusTxt" class="status">Status: <strong>Idle</strong></div>
      </div>
      <div class="chips" id="chips"></div>
      <div class="hint" id="examplesHint"></div>
    </div>

    <div class="grid">
      <div class="card">
        <div class="row" style="justify-content:space-between">
          <h3>Planned Flow</h3>
          <button id="copyBtn" class="btn ghost">Copy JSON</button>
        </div>
        <pre id="flowBox">Click “Plan” to see the JSON plan.</pre>
      </div>

      <div class="card">
        <h3>Run Console</h3>
        <pre id="consoleBox">—</pre>
        <div id="shotsWrap" style="display:none"><div class="hint">Screenshots</div><div id="shots" class="shots"></div></div>
        <div id="videoWrap" style="display:none; margin-top:10px"><a id="videoLink" target="_blank">Open recorded video</a></div>
      </div>
    </div>

    <footer>© Mediad</footer>
  </div>

<script>
(function(){
  const $=s=>document.querySelector(s);
  const prompt=$("#prompt"),planBtn=$("#planBtn"),runBtn=$("#runBtn"),copyBtn=$("#copyBtn");
  const flowBox=$("#flowBox"),consoleBox=$("#consoleBox"),statusTxt=$("#statusTxt").querySelector("strong");
  const shotsWrap=$("#shotsWrap"),shotsEl=$("#shots"),videoWrap=$("#videoWrap"),videoLink=$("#videoLink");
  const chips=$("#chips"),examplesHint=$("#examplesHint");

  // Examples without hard-coded emails
  const examples=[
    "Screenshot https://www.cnn.com and email to …",
    "Save https://example.com as PDF and email to …",
    "Open https://news.google.com and take a screenshot"
  ];
  examples.forEach(t=>{const b=document.createElement("button");b.className="chip";b.textContent=t;b.onclick=()=>{prompt.value=t};chips.appendChild(b)});
  examplesHint.textContent='Examples: “Screenshot https://www.cnn.com and email to …” · “Save https://example.com as PDF and email to …”';

  let flow=null,runId=null,poll=null;

  function setStatus(s){statusTxt.textContent=s}
  function setConsole(lines){consoleBox.textContent=lines&&lines.length?lines.join("\n"):"—"}
  function setShots(list){
    if(!list||!list.length){shotsWrap.style.display="none";shotsEl.innerHTML="";return}
    shotsWrap.style.display="";
    shotsEl.innerHTML="";
    list.forEach(s=>{
      const a=document.createElement("a");a.href=s.url;a.target="_blank";a.className="thumb";
      const img=document.createElement("img");img.src=s.url;img.alt="screenshot";
      a.appendChild(img);shotsEl.appendChild(a);
    });
  }

  async function j(url,opt){const r=await fetch(url,{...opt,headers:{"content-type":"application/json"}});return await r.json()}

  async function plan(){
    setStatus("Planning…");flow=null;flowBox.textContent="Planning…";setConsole([]);setShots(null);videoWrap.style.display="none";
    try{
      const d=await j("/api/plan",{method:"POST",body:JSON.stringify({prompt:prompt.value})});
      flow=d.flow||null;flowBox.textContent=flow?JSON.stringify(flow,null,2):"No plan generated. Replace “…” with a real email and try again.";setStatus("Planned");
    }catch{setStatus("Plan error");flowBox.textContent="Planning failed. Try again."}
  }

  async function run(){
    if(!flow){await plan();if(!flow)return}
    setStatus("Running…");setConsole([]);setShots(null);videoWrap.style.display="none";
    try{
      const d=await j("/api/run",{method:"POST",body:JSON.stringify({flow})});
      runId=d.id;if(!runId){setStatus("Run error");return}
      poll&&clearInterval(poll);
      poll=setInterval(async()=>{
        try{
          const s=await j("/api/run/"+runId);
          setConsole(s.logs||[]);setShots(s.shots||[]);
          if(s.videoUrl){videoWrap.style.display="";videoLink.href=s.videoUrl;videoLink.textContent="Open recorded video"}
          if(s.status==="done"){setStatus("Done");clearInterval(poll)}
          if(s.status==="error"){setStatus("Error");clearInterval(poll)}
        }catch{}
      },1200);
    }catch{setStatus("Run error")}
  }

  planBtn.onclick=plan;
  runBtn.onclick=run;
  copyBtn.onclick=()=>{if(!flow)return;navigator.clipboard.writeText(JSON.stringify(flow,null,2));copyBtn.textContent="Copied";setTimeout(()=>copyBtn.textContent="Copy JSON",800)}
})();
</script>
</body>
</html>
                                                                                
  
  
  
  
                                                                                
  
  
  
  
                                                            
  
  
  
