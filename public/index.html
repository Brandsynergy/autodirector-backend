<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Mediad AutoDirector</title>
  <style>
    :root { color-scheme: dark; }
    body { margin:0; font-family: system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, sans-serif; background:#0b0f13; color:#e6ebf0; }
    .wrap { max-width: 1100px; margin: 32px auto; padding: 0 16px; }
    h1 { font-size: 34px; margin: 0 0 8px; }
    .muted { color:#9aa7b2; font-size:14px; margin-bottom:24px; }
    .card { background:#121820; border:1px solid #1a2330; border-radius:14px; padding:18px; margin-bottom:18px; }
    label { display:block; font-size:14px; color:#9aa7b2; margin-bottom:8px; }
    input, textarea { width:100%; background:#0f141b; color:#e6ebf0; border:1px solid #1a2330; border-radius:10px; padding:14px; font-size:16px; }
    textarea { min-height:100px; }
    .row { display:grid; grid-template-columns: 1fr 1fr; gap:14px; }
    .btn { display:inline-block; background:#5ba3ff; color:#00132b; border:0; padding:14px 18px; border-radius:12px; font-weight:700; cursor:pointer; width:100%; text-align:center; }
    .cols { display:grid; grid-template-columns: 1fr 1fr; gap:18px; }
    pre { background:#0f141b; border:1px solid #1a2330; padding:12px; border-radius:10px; overflow:auto; font-size:13px; }
    .chips { display:flex; gap:10px; flex-wrap:wrap; margin-top:10px; }
    .chip { border:1px dashed #223047; color:#b8c4cf; padding:8px 10px; border-radius:999px; font-size:12px; cursor:pointer; }
    .ok { color:#5fff90; }
    .err { color:#ff6b6b; }
  </style>
</head>
<body>
  <div class="wrap">
    <h1>Mediad AutoDirector</h1>
    <div class="muted">Natural-language ➜ actions (plus a simple one-click screenshot sender).</div>

    <!-- NATURAL LANGUAGE -->
    <div class="card">
      <label>Describe what to automate</label>
      <textarea id="prompt" placeholder='E.g. "Screenshot https://cnn.com and email it to you@example.com"'></textarea>
      <div class="chips">
        <span class="chip" data-eg='Screenshot https://cnn.com and email it to support@mivado.co'>Screenshot https://cnn.com and email it…</span>
        <span class="chip" data-eg='Get the latest links from https://inc.com and email to support@mivado.co'>Get latest links from inc.com…</span>
        <span class="chip" data-eg='Create image of an ultrarealistic elephant with wings and send to support@mivado.co'>Create an image and send it…</span>
      </div>
      <div style="margin-top:12px" class="row">
        <button id="btnPlan" class="btn">Plan</button>
        <button id="btnRun" class="btn">Run</button>
      </div>

      <div class="cols" style="margin-top:16px">
        <div>
          <h3>Planned Flow</h3>
          <pre id="planBox">{ }</pre>
        </div>
        <div>
          <h3>Run Console</h3>
          <pre id="runBox">{ }</pre>
        </div>
      </div>
    </div>

    <!-- SIMPLE SCREENSHOT SENDER -->
    <div class="card">
      <h3>Capture a web page and email the screenshot.</h3>
      <div class="row">
        <div>
          <label>Website URL</label>
          <input id="ssUrl" placeholder="https://www.cnn.com" value="https://www.cnn.com"/>
        </div>
        <div>
          <label>Destination email</label>
          <input id="ssTo" placeholder="you@example.com (optional)"/>
        </div>
      </div>
      <div style="margin-top:12px">
        <button id="btnCapture" class="btn">Capture &amp; Email</button>
      </div>
      <div style="margin-top:12px">
        <div id="simpleStatus" class="muted"></div>
      </div>
    </div>
  </div>

  <script>
    const $ = (id) => document.getElementById(id);

    // Sample chips
    document.querySelectorAll(".chip").forEach(ch => {
      ch.addEventListener("click", () => { $("prompt").value = ch.dataset.eg; });
    });

    $("btnPlan").onclick = async () => {
      const prompt = $("prompt").value.trim();
      $("planBox").textContent = "planning…";
      const r = await fetch("/plan", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ prompt })
      });
      const j = await r.json();
      $("planBox").textContent = JSON.stringify(j, null, 2);
    };

    $("btnRun").onclick = async () => {
      const plan = $("planBox").textContent;
      let steps = null;
      try {
        const parsed = JSON.parse(plan);
        steps = parsed.steps;
      } catch {}
      if (!steps) {
        // call /plan first
        await $("btnPlan").onclick();
        const parsed = JSON.parse($("planBox").textContent || "{}");
        steps = parsed.steps;
      }
      if (!steps) {
        $("runBox").textContent = JSON.stringify({ ok:false, error:"No steps" }, null, 2);
        return;
      }
      $("runBox").textContent = "running…";
      const r = await fetch("/run", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ steps })
      });
      const j = await r.json();
      $("runBox").textContent = JSON.stringify(j, null, 2);
    };

    $("btnCapture").onclick = async () => {
      $("simpleStatus").textContent = "running…";
      const url = $("ssUrl").value.trim();
      const to = $("ssTo").value.trim();
      // run directly
      const steps = [
        { action: "screenshot_url", url },
        { action: "gmail_send_last", to }
      ];
      const r = await fetch("/run", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ steps })
      });
      const j = await r.json();
      if (j.ok) {
        const shot = j.results.find(x => x.action === "screenshot_url");
        const path = shot?.path ? location.origin + shot.path : "(none)";
        $("simpleStatus").innerHTML = `<span class="ok">Done</span>: <a href="${path}" target="_blank">${path}</a>`;
      } else {
        $("simpleStatus").innerHTML = `<span class="err">${j.error || "Unknown error"}</span>`;
      }
    };
  </script>
</body>
</html>
                                        
  
  
                    
                      
                      
  
                                                            
  
  
  
                                                                                
  
  
  
  
                                                                                                    
  
  
  
  
  
                                                                                                    
  
  
  
  
  
                                                                                
  
  
  
  
                                                                                
  
  
  
  
                                                                                
  
  
  
  
                                                            
  
  
  
